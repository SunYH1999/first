<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" id="viewport" />
	<link rel="stylesheet" type="text/css" href="css/reset.css">
	<link rel="stylesheet" type="text/css" href="css/index.css">
	<title>携程，说走就走</title>
	<style type="text/css">
		#carousel {
			transition: all 1s ease 0s;
		}
	</style>
</head>
<body>
	<header>
		<div>搜索：目的地/酒店/景点/航班号</div>
		<a href="">我 的</a>
	</header>
	<div class="banner">
		<ul id="carousel">
			<li><img src="images/banner0.jpg" alt="" /></li>
			<li><img src="images/banner1.jpg" alt="" /></li>
			<li><img src="images/banner2.jpg" alt="" /></li>
			<li><img src="images/banner3.jpg" alt="" /></li>
			<li><img src="images/banner4.jpg" alt="" /></li>
			<li><img src="images/banner0.jpg" alt="" /></li>
		</ul>
	</div>
	<section>
		<ul>
			<li><a href="">酒 店</a></li>
			<li><a href="">海外酒店</a></li>
			<li><a href="">团 购</a></li>
			<li><a href="">特价酒店</a></li>
			<li><a href="">民宿·客栈</a></li>
		</ul>
		<ul>
			<li><a href="">机 票</a></li>
			<li><a href="">火车票·抢票</a></li>
			<li><a href="">汽车票·船票</a></li>
			<li><a href="">特价机票</a></li>
			<li><a href="">专车·租车</a></li>
		</ul>
		<ul>
			<li><a href="">旅 游</a></li>
			<li><a href="">目的地攻略</a></li>
			<li><a href="">邮 轮</a></li>
			<li><a href="">周边游</a></li>
			<li><a href="">定制旅行</a></li>
		</ul>
		<ul>
			<li><a href="">景点·玩乐</a></li>
			<li><a href="">美食林</a></li>
			<li><a href="">全球购·换汇</a></li>
			<li><a href="">礼品卡</a></li>
			<li><a href="">WiFi·电话卡</a></li>
			<li><a href="">保险·签证</a></li>
		</ul>
	</section>
	<!-- 副导航栏 -->
	<nav>
		<ul>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
			<li><a href="">自由行</a></li>
		</ul>
	</nav>
	<!-- 特卖惠放个H1然后大于号用边框旋转制 作 -->
	<!-- 中间部分 -->
	<div class="main">
		<div class="top">
			<h1>特卖会</h1>
			<a href="">领红包再下单<span></span></a>
		</div>
		<div class="btm">
			<div class="left">
				<img src="images/33.jpg" alt="p">
				<span>爆款</span>
				<div>
					<p>广西桂林4日3晚自由行（5钻）·5星桂林漓江大瀑布酒店3晚，含双早+双飞含双早+双飞含双早+含双早+双飞含双早+双飞含双早+</p>
					<p>
						<span>¥</span>
							1999起
						<span>省¥491</span>
					</p>
				</div>
			</div>
			<div class="right">
				<div>
					<h3>千款特价</h3>
					<p>走过路过不错过</p>
				</div>
				<div>
					<div>
						<h3>海外精选</h3>
						<p><span>百元</span>出境游</p>
					</div>
					<div>
						<h3>周边玩乐</h3>
						<p><span>一元</span>度周末</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="active">
		<div class="atop">
			<h3>热门活动<span></span></h3>
			<a href="">获取更多福利<span></span></a>
		</div>
		<div>
			<ul class="pic">
				<li><a href=""><img src="images/ad1_2.jpg" alt="p"></a></li>
				<li><a href=""><img src="images/ad2.jpg" alt="p"></a></li>
				<li><a href=""><img src="images/ad3.jpg" alt="p"></a></li>
				<li><a href=""><img src="images/ad4.jpg" alt="p"></a></li>
				<li><a href=""><img src="images/ad5.jpg" alt="p"></a></li>
			</ul>
		</div>
	</div>
	<footer>
		<ul>
			<li><p>电话预定</p></li>
			<li><p>下载客户端</p></li>
			<li><p>我的</p></li>
		</ul>
	</footer>
	<div class="bbtm">
		<p>网站地图 | Global sites | 电脑版</p>
		<p>&copy;2017携程</p>
	</div>
	<script type="text/javascript">
		// 计算banner的高度
		// 计算图片的宽与高之比
		var r = 768 / 154;
		// 获取整体宽度
		var width = document.documentElement.clientWidth;
		// 获取高度
		var height = width / r;
		// 设置高度
		var banner = document.querySelector(".banner");
		banner.style.height = height + "px";

		// 获取元素
		var carousel = document.querySelector("#carousel");
		var lis = carousel.querySelectorAll("li");
		// 设置锁
		var lock = true;
		// 定义信号量
		var idx = 0;
		// 定义一个变量 用于中转
		var left = 0;
		// 绑定事件
		carousel.addEventListener("touchstart", function(e) {
			if(!lock) {return}

			// 获取手指按下的位置
			left = e.touches[0].clientX;
			// 取消过渡
			carousel.style.transition = "none";
		}, false);

		// 添加move事件
		carousel.addEventListener("touchmove", function(e) {
			if(!lock) {return}

			// 实时移动
			var x = e.touches[0].clientX;
			// 如果此时idx是0 并且还是向右滑动 此时应该跳转到猫腻图的位置
			if(x - left > 0 && idx === 0) {
				carousel.style.left = (lis.length - 1) * -width + x - left + "px";
				return;
			}
			carousel.style.left = -idx * width + x - left + "px";
		});

		carousel.addEventListener("touchend", function(e) {
			if(!lock) {return};
			lock = false;
			// 手指离开 要加过渡
			carousel.style.transition = "all 1s ease 0s";
			// 手指离开 要根据手指离开的位置与手指按下的位置判断用户往左还是往右移动
			var x = e.changedTouches[0].clientX;
			if(x - left > 0) {
				// 手指往右移动 查看左侧图片
				idx--; 
				if(idx < 0) {
					idx = lis.length - 1;
					idx--;
				}
			} else if(x - left < 0) {
				// 手指往左移动 查看右侧图片
				idx++;
				// 加边界判定
			} else {
				// 手指没动
				return;
			}
			carousel.style.left = -idx * width + "px";
		});

		carousel.addEventListener("transitionend", function() {
			console.log(123);
			if(idx >= lis.length - 1) {
				// 如果是最后一张 此时要让过渡完成 之后再改变left值
				carousel.style.transition = "none";
				idx = 0;
				carousel.style.left = -idx * width + "px";
			}
			lock = true;
		})
	</script>
</body>
</html>